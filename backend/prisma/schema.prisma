generator client {
        provider = "prisma-client"
        output   = "./generated"
}

datasource db {
        provider = "postgresql"
}

enum UserType {
        GUEST
        AUTHENTICATED
}

enum Function {
        TRANSLATE
        BACKGROUNDREMOVE
        VOICECHAT
}

model User {
        id             Int                @id @default(autoincrement())
        email          String?            @unique
        name           String?            @default("Guest")
        ipAddress      String             @map("ip_address")
        userAgent      String             @map("user_agent")
        googleId       String?            @unique @map("google_id")
        profilePicture String?            @map("profile_picture")
        features       UserFeatureUsage[]
        userType       UserType           @default(GUEST)
        createdAt      DateTime           @default(now()) @map("created_at")
        updatedAt      DateTime           @updatedAt @map("updated_at")

        @@index([email, googleId])
        @@map("users")
}

model UserFeatureUsage {
        id        Int      @id @default(autoincrement())
        userId    Int
        feature   Function
        user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
        useage    Int      @default(0)
        createdAt DateTime @default(now()) @map("created_at")
        updatedAt DateTime @updatedAt @map("updated_at")

        @@unique([feature, userId])
        @@index([feature, userId])
        @@index([userId])
        @@map("features")
}

model LanguageList {
        id            Int      @id @default(autoincrement())
        language      String   @unique
        language_code String   @unique
        createdAt     DateTime @default(now()) @map("created_at")
        updatedAt     DateTime @updatedAt @map("updated_at")

        @@index([language_code, language])
        @@map("language_lists")
}
